[gd_scene load_steps=19 format=3 uid="uid://ctgkokatj7ys8"]

[ext_resource type="Script" uid="uid://cqbo7v5wxwo7d" path="res://Scripts/raycast_car.gd" id="1_kay1j"]
[ext_resource type="Curve" uid="uid://s0owfk7gyqpf" path="res://Scenes/car_FAST_curve.tres" id="2_7bly4"]
[ext_resource type="Texture2D" uid="uid://rpn12jgw0lym" path="res://Textures/cabin.png" id="2_emrxg"]
[ext_resource type="Script" uid="uid://5blvo8srys23" path="res://Scripts/raycast_wheel.gd" id="2_h18c2"]
[ext_resource type="Curve" uid="uid://cn7f6mjw1axgc" path="res://Scenes/car_tire_FRONT.tres" id="3_p5wsr"]
[ext_resource type="Script" uid="uid://cvttlogb7x7ox" path="res://Scenes/car_follow_camera.gd" id="4_omo7q"]
[ext_resource type="Curve" uid="uid://d3rqxa4rlsba7" path="res://Scenes/car_tire_BACK.tres" id="5_7bly4"]

[sub_resource type="BoxMesh" id="BoxMesh_tdm8s"]
size = Vector3(2, 0.5, 4)

[sub_resource type="BoxMesh" id="BoxMesh_kay1j"]
size = Vector3(0.68, 0.4, 1.8)

[sub_resource type="BoxShape3D" id="BoxShape3D_emrxg"]
size = Vector3(2, 0.5, 4)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_h18c2"]
albedo_texture = ExtResource("2_emrxg")

[sub_resource type="CylinderMesh" id="CylinderMesh_omo7q"]
top_radius = 0.4
bottom_radius = 0.4
height = 0.15

[sub_resource type="Gradient" id="Gradient_h18c2"]
offsets = PackedFloat32Array(0.263636, 1)
colors = PackedColorArray(0, 0, 0, 1, 0, 0, 0, 0)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_omo7q"]
gradient = SubResource("Gradient_h18c2")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_onl27"]
gravity = Vector3(0, 0, 0)
color_ramp = SubResource("GradientTexture1D_omo7q")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_omo7q"]
transparency = 1
vertex_color_use_as_albedo = true

[sub_resource type="QuadMesh" id="QuadMesh_onl27"]
material = SubResource("StandardMaterial3D_omo7q")
size = Vector2(0.6, 1)
orientation = 1

[sub_resource type="BoxShape3D" id="BoxShape3D_7bly4"]
size = Vector3(3.72, 0.7, 3.275)

[node name="Car" type="RigidBody3D" node_paths=PackedStringArray("wheels", "skid_marks")]
mass = 50.0
linear_damp_mode = 1
script = ExtResource("1_kay1j")
wheels = [NodePath("WheelFL"), NodePath("WheelRL"), NodePath("WheelFR"), NodePath("WheelRR")]
acceleration = 450.0
max_speed = 60.0
accel_curve = ExtResource("2_7bly4")
tire_turn_speed = null
tire_max_turn_degress = null
total_wheels = null
skid_marks = [NodePath("SkidMarks/GPUParticles3D"), NodePath("SkidMarks/GPUParticles3D2"), NodePath("SkidMarks/GPUParticles3D3"), NodePath("SkidMarks/GPUParticles3D4")]
driver = null

[node name="CarMesh" type="MeshInstance3D" parent="."]
mesh = SubResource("BoxMesh_tdm8s")

[node name="MeshInstance3D" type="MeshInstance3D" parent="CarMesh"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.00547457, 0.44684, 0.997009)
mesh = SubResource("BoxMesh_kay1j")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
shape = SubResource("BoxShape3D_emrxg")

[node name="WheelFL" type="RayCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.1, 0, -1.3)
enabled = false
script = ExtResource("2_h18c2")
spring_strength = 5000.0
spring_damping = 120.0
over_extend = 0.2
is_motor = true
is_steer = true
grip_curve = ExtResource("3_p5wsr")

[node name="Wheel" type="MeshInstance3D" parent="WheelFL"]
transform = Transform3D(-4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 0, 0, 1, 0, -0.5, 0)
material_override = SubResource("StandardMaterial3D_h18c2")
mesh = SubResource("CylinderMesh_omo7q")

[node name="WheelFR" type="RayCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.1, 0, -1.3)
enabled = false
script = ExtResource("2_h18c2")
spring_strength = 5000.0
spring_damping = 120.0
over_extend = 0.2
is_motor = true
is_steer = true
grip_curve = ExtResource("3_p5wsr")

[node name="Wheel" type="MeshInstance3D" parent="WheelFR"]
transform = Transform3D(-4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 0, 0, 1, 0, -0.5, 0)
material_override = SubResource("StandardMaterial3D_h18c2")
mesh = SubResource("CylinderMesh_omo7q")

[node name="WheelRL" type="RayCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.1, 0, 1.3)
enabled = false
script = ExtResource("2_h18c2")
spring_strength = 5000.0
spring_damping = 120.0
over_extend = 0.2
grip_curve = ExtResource("5_7bly4")

[node name="Wheel" type="MeshInstance3D" parent="WheelRL"]
transform = Transform3D(-4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 0, 0, 1, 0, -0.5, 0)
material_override = SubResource("StandardMaterial3D_h18c2")
mesh = SubResource("CylinderMesh_omo7q")

[node name="WheelRR" type="RayCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.1, 0, 1.3)
enabled = false
script = ExtResource("2_h18c2")
spring_strength = 5000.0
spring_damping = 120.0
over_extend = 0.2
grip_curve = ExtResource("5_7bly4")

[node name="Wheel" type="MeshInstance3D" parent="WheelRR"]
transform = Transform3D(-4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 0, 0, 1, 0, -0.5, 0)
material_override = SubResource("StandardMaterial3D_h18c2")
mesh = SubResource("CylinderMesh_omo7q")

[node name="SkidMarks" type="Node3D" parent="."]

[node name="GPUParticles3D" type="GPUParticles3D" parent="SkidMarks"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.82006, 0, 0.465238)
emitting = false
amount = 150
lifetime = 1.5
fixed_fps = 60
process_material = SubResource("ParticleProcessMaterial_onl27")
draw_pass_1 = SubResource("QuadMesh_onl27")

[node name="GPUParticles3D2" type="GPUParticles3D" parent="SkidMarks"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.82006, 0, 0.465238)
emitting = false
amount = 150
lifetime = 1.5
fixed_fps = 60
process_material = SubResource("ParticleProcessMaterial_onl27")
draw_pass_1 = SubResource("QuadMesh_onl27")

[node name="GPUParticles3D3" type="GPUParticles3D" parent="SkidMarks"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.82006, 0, 0.465238)
emitting = false
amount = 150
lifetime = 1.5
fixed_fps = 60
process_material = SubResource("ParticleProcessMaterial_onl27")
draw_pass_1 = SubResource("QuadMesh_onl27")

[node name="GPUParticles3D4" type="GPUParticles3D" parent="SkidMarks"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.82006, 0, 0.465238)
emitting = false
amount = 150
lifetime = 1.5
fixed_fps = 60
process_material = SubResource("ParticleProcessMaterial_onl27")
draw_pass_1 = SubResource("QuadMesh_onl27")

[node name="CameraPivot" type="Node3D" parent="."]

[node name="Camera3D" type="Camera3D" parent="CameraPivot"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 4)
top_level = true
script = ExtResource("4_omo7q")

[node name="CharacterDetect" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.11, 0)

[node name="CollisionShape3D" type="CollisionShape3D" parent="CharacterDetect"]
shape = SubResource("BoxShape3D_7bly4")

[node name="DriverSeat" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.48, 0, -0.765)

[node name="PassengerSeat" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.48, 0, -0.765)

[connection signal="body_shape_entered" from="CharacterDetect" to="." method="_on_character_detect_body_shape_entered"]
[connection signal="body_shape_exited" from="CharacterDetect" to="." method="_on_character_detect_body_shape_exited"]
